<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pedidos - Quinta Real Almanza</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f0f0f0; }
        .contenedor { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
        header { text-align: center; border-bottom: 2px solid #003366; margin-bottom: 20px; }
        
        .zona-seleccion { margin-bottom: 20px; padding: 10px; background: #e9e9e9; border-radius: 5px; }
        
        .producto { display: flex; align-items: center; justify-content: space-between; 
                    padding: 15px; border: 1px solid #ddd; margin-bottom: 10px; border-radius: 8px; }
        
        /* Espacio para la imagen futura */
        .foto-plato { width: 80px; height: 80px; background: #ccc; border-radius: 5px; margin-right: 15px; }
        
        .info { flex-grow: 1; }
        .precio { font-weight: bold; color: #003366; }
        
        button { background-color: #D4AF37; color: #003366; border: none; 
                 padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:active { background-color: #b8962d; }
    </style>
</head>
<body>

<div class="contenedor">
    <header>
        <h1>Quinta Real Almanza</h1>
        <p>Menú Digital</p>
    </header>

    <div class="zona-seleccion">
        <label>¿Dónde se encuentra?</label>
        <select id="zona-cliente" style="width: 100%; padding: 10px; margin-top: 5px;">
            <option value="Piscina">Piscina</option>
            <option value="Ranchón">Ranchón</option>
            <option value="Campo de Béisbol">Campo de Béisbol</option>
            <option value="Barra">Barra</option>
        </select>
    </div>

    <div class="producto">
        <div class="foto-plato"></div> <div class="info">
            <div style="font-weight: bold;">Churrasco</div>
            <div class="precio">C$ 300.00</div>
        </div>
        <button onclick="enviarPedido('Churrasco', 300)">PEDIR</button>
    </div>

    <div class="producto">
        <div class="foto-plato"></div> <div class="info">
            <div style="font-weight: bold;">Tacos de Pollo</div>
            <div class="precio">C$ 110.00</div>
        </div>
        <button onclick="enviarPedido('Tacos de Pollo', 110)">PEDIR</button>
    </div>
</div>

<script src="config.js"></script>

<script>
async function enviarPedido(nombrePlato, precioPlato) {
    const ubicacion = document.getElementById('zona-cliente').value;
    
    // Confirmación simple
    if (!confirm("¿Confirmar pedido de " + nombrePlato + " para " + ubicacion + "?")) return;

    // Datos desde DATOS_DE_GITHUB en tu config.js
    const TOKEN = DATOS_DE_GITHUB.TOKEN;
    const USER = DATOS_DE_GITHUB.USUARIO;
    const REPO = DATOS_DE_GITHUB.REPO;

    const datosPedido = {
        plato: nombrePlato,
        precio: precioPlato,
        lugar: ubicacion,
        fecha: new Date().toLocaleString()
    };

    const nombreArchivo = `pedido-${Date.now()}.json`;
    const contenidoBase64 = btoa(JSON.stringify(datosPedido, null, 2));

    try {
        const respuesta = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/pedidos/${nombreArchivo}`, {
            method: 'PUT',
            headers: {
                'Authorization': `token ${TOKEN}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                message: "Nuevo pedido desde el menú",
                content: contenidoBase64
            })
        });

        if (respuesta.ok) {
            alert("Pedido enviado correctamente. ¡En breve lo llevamos!");
        } else {
            alert("Hubo un error con el Token. Verifica tu archivo config.js");
        }
    } catch (error) {
        alert("Error de conexión. Asegúrate de tener internet.");
    }
}
</script>

</body>
</html>
